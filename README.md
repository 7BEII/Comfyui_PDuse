# ComfyUI PDuse è‡ªå®šä¹‰èŠ‚ç‚¹é›†

ComfyUIçš„è‡ªå®šä¹‰èŠ‚ç‚¹é›†åˆï¼Œä¸“æ³¨äºå›¾åƒå¤„ç†å’ŒåŠ¨ç”»ç”Ÿæˆã€‚

## ğŸ“¦ å®‰è£…

1. å…‹éš†ä»“åº“åˆ°ComfyUIçš„custom_nodesç›®å½•ï¼š
```bash
cd ComfyUI/custom_nodes
git clone https://github.com/your-repo/Comfyui_PDuse.git
```

2. å®‰è£…ä¾èµ–ï¼š
```bash
cd Comfyui_PDuse
pip install -r requirements.txt
```

3. é‡å¯ComfyUI

## ğŸ“‹ ä¾èµ–é¡¹

```
xlrd
openpyxl
scipy
numpy
Pillow
torch
torchvision
opencv-python
```

---

## ğŸ¬ èŠ‚ç‚¹åˆ—è¡¨

### 1. PD:Image FengMian Wipe

åˆ›å»ºä¸¤å¼ å›¾ç‰‡ä¹‹é—´çš„æ“¦é™¤è¿‡æ¸¡åŠ¨ç”»æ•ˆæœã€‚

#### è¾“å…¥å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ |
|------|------|--------|------|------|
| `top_image` | IMAGE | - | - | ä¸Šå±‚å›¾åƒï¼ˆè¢«æ“¦é™¤ï¼‰ |
| `bottom_image` | IMAGE | - | - | åº•å±‚å›¾åƒï¼ˆè¢«æ˜¾ç¤ºï¼‰ |
| `num_frames` | INT | 30 | 2-600 | è¿‡æ¸¡å¸§æ•° |
| `angle_deg` | FLOAT | 0 | -180~180 | æ“¦é™¤è§’åº¦ï¼ˆ0=æ°´å¹³ï¼‰ |
| `smooth_width` | INT | 20 | 0-4096 | æ¸å˜å¸¦å®½åº¦ï¼ˆ0=ç¡¬è¾¹ï¼‰ |
| `edge_sharpness` | FLOAT | 2.0 | 0.1-10.0 | è¾¹ç¼˜é”åŒ–ç¨‹åº¦ |
| `edge_line_width` | FLOAT | 0.0 | 0-10.0 | è¾¹ç¼˜çº¿ç²—ç»†ï¼ˆ0=æ— çº¿ï¼‰ |
| `edge_line_color` | STRING | "#ffffff" | åå…­è¿›åˆ¶ | è¾¹ç¼˜çº¿é¢œè‰² |
| `reverse` | BOOLEAN | False | - | æ˜¯å¦åå‘æ“¦é™¤ |
| `liner_image` | IMAGE (å¯é€‰) | - | - | è¾¹ç¼˜çº¿å›¾æ ‡ |
| `liner_image_mask` | MASK (å¯é€‰) | - | - | å›¾æ ‡é®ç½© |

#### è¾“å‡º

| è¾“å‡º | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `frames` | IMAGE | è¿‡æ¸¡å¸§åºåˆ— |

#### åŸºç¡€ä½¿ç”¨

```
[Load Image: å›¾ç‰‡A] â†’ top_image
[Load Image: å›¾ç‰‡B] â†’ bottom_image
    â†“
[PD:Image FengMian Wipe]
- num_frames: 30
- angle_deg: 0 (æ°´å¹³æ»‘åŠ¨)
- smooth_width: 40
    â†“
frames â†’ [åç»­å¤„ç†èŠ‚ç‚¹]
```

---

### ğŸ“ æ ¸å¿ƒå‚æ•°è¯¦è§£

#### 1. angle_degï¼ˆæ“¦é™¤è§’åº¦ï¼‰

æ§åˆ¶æ“¦é™¤çº¿çš„æ–¹å‘ï¼š

| è§’åº¦ | æ–¹å‘ | æ•ˆæœ |
|------|------|------|
| 0Â° | æ°´å¹³ | ä»å·¦åˆ°å³ â†’  |
| 90Â° | å‚ç›´ | ä»ä¸Šåˆ°ä¸‹ â†“ |
| 45Â° | æ–œå‘ | ä»å·¦ä¸Šåˆ°å³ä¸‹ â†˜ |
| -45Â° | æ–œå‘ | ä»å·¦ä¸‹åˆ°å³ä¸Š â†— |

#### 2. smooth_widthï¼ˆæ¸å˜å®½åº¦ï¼‰

æ§åˆ¶è¿‡æ¸¡è¾¹ç¼˜çš„æŸ”å’Œç¨‹åº¦ï¼š

| å€¼ | æ•ˆæœ | é€‚ç”¨åœºæ™¯ |
|----|------|---------|
| 0 | ç¡¬è¾¹ï¼Œç¬é—´åˆ‡æ¢ | æ•°å­—æ•ˆæœã€æ•…éšœé£æ ¼ |
| 20-50 | æŸ”å’Œè¿‡æ¸¡ | é€šç”¨åœºæ™¯ â­ |
| 100+ | éå¸¸æŸ”å’Œ | æ¢¦å¹»ã€æŸ”ç„¦æ•ˆæœ |

#### 3. edge_sharpnessï¼ˆè¾¹ç¼˜é”åŒ–ï¼‰

æ§åˆ¶è¿‡æ¸¡è¾¹ç¼˜çš„æ¸…æ™°åº¦ï¼š

| å€¼ | æ•ˆæœ | ç‰¹ç‚¹ |
|----|------|------|
| 0.5 | éå¸¸æŸ”å’Œ | è¾¹ç¼˜æ¨¡ç³Šï¼Œæ¸å˜å¾ˆå®½ |
| 1.0 | çº¿æ€§è¿‡æ¸¡ | æ ‡å‡†å¹³æ»‘è¿‡æ¸¡ |
| 2.0 | ä¸­ç­‰é”åŒ– | æ¨èå€¼ â­ |
| 5.0+ | éå¸¸é”åˆ© | è¾¹ç¼˜æ˜æ˜¾ï¼Œç±»ä¼¼ç¡¬è¾¹ |

**å·¥ä½œåŸç†**ï¼šä½¿ç”¨å¹‚å‡½æ•° `alpha^(1/sharpness)` å¯¹è¿‡æ¸¡æ›²çº¿è¿›è¡Œéçº¿æ€§å˜æ¢ã€‚

---

### ğŸ¨ è¾¹ç¼˜çº¿åŠŸèƒ½

#### edge_line_widthï¼ˆè¾¹ç¼˜çº¿å®½åº¦ï¼‰

åœ¨è¿‡æ¸¡è¾¹ç¼˜ä¸­å¿ƒæ·»åŠ ä¸€æ¡å½©è‰²çº¿ï¼š

| å€¼ | æ•ˆæœ |
|----|------|
| 0 | æ— è¾¹ç¼˜çº¿ |
| 0.5-1.0 | ç»†çº¿ï¼Œç²¾è‡´ |
| 2.0-3.0 | ä¸­ç­‰ç²—ç»† â­ |
| 5.0+ | ç²—çº¿ï¼Œé†’ç›® |

**æ”¯æŒå°æ•°ç²¾åº¦**ï¼šå¯ä»¥è®¾ç½® `0.5`, `1.5`, `2.5` ç­‰å€¼ã€‚

#### edge_line_colorï¼ˆè¾¹ç¼˜çº¿é¢œè‰²ï¼‰

ä½¿ç”¨åå…­è¿›åˆ¶é¢œè‰²å€¼ï¼š

**å¸¸ç”¨é¢œè‰²**ï¼š
```
ç™½è‰²: #ffffff (é»˜è®¤)
é»‘è‰²: #000000 æˆ– #000
çº¢è‰²: #ff0000 æˆ– #f00
è“è‰²: #0078ff (ç§‘æŠ€è“)
é‡‘è‰²: #ffd700
ç»¿è‰²: #00ff00 æˆ– #0f0
```

**æ”¯æŒæ ¼å¼**ï¼š
- 6ä½: `#ffffff` (æ¨è)
- 3ä½ç®€å†™: `#fff`
- å¯çœç•¥#å·: `ffffff`

---

### ğŸ–¼ï¸ è¾¹ç¼˜çº¿å›¾æ ‡åŠŸèƒ½

åœ¨è¾¹ç¼˜çº¿ä¸Šå åŠ è·Ÿéšç§»åŠ¨çš„å›¾æ ‡ï¼ˆlogoã€ç®­å¤´ç­‰ï¼‰ã€‚

#### ä½¿ç”¨æ–¹æ³•

```
[Load Image: Logo.png] â†’ liner_image
[Image to Mask: Logo] â†’ liner_image_mask
    â†“
[PD:Image FengMian Wipe]
â†’ å›¾æ ‡ä¼šè·Ÿéšè¾¹ç¼˜çº¿ç§»åŠ¨
```

#### å›¾æ ‡è¦æ±‚

- **æ ¼å¼**: PNGï¼ˆæ”¯æŒé€æ˜åº¦ï¼‰
- **å°ºå¯¸å»ºè®®**:
  - 1080p: 50-150px
  - 4K: 100-300px
  - æ¨èï¼šç”»é¢çŸ­è¾¹çš„ 1/10 - 1/15
- **è®¾è®¡åŸåˆ™**:
  - ç®€æ´æ˜äº†
  - è½®å»“æ¸…æ™°
  - å¯¹æ¯”åº¦é«˜
  - åœ†å½¢æˆ–æ–¹å½¢

#### ç‰¹æ€§

- âœ… è‡ªåŠ¨è·Ÿéšè¾¹ç¼˜çº¿ç§»åŠ¨
- âœ… å±…ä¸­å¯¹é½åˆ°è¾¹ç¼˜ä¸­å¿ƒ
- âœ… ä½¿ç”¨maskå®ç°å¹³æ»‘é€æ˜
- âœ… è‡ªåŠ¨å¤„ç†è¾¹ç•Œè£å‰ª
- âœ… å¯é€‰åŠŸèƒ½ï¼ˆä¸è¿æ¥åˆ™ä¸æ˜¾ç¤ºï¼‰

---

### ğŸ¯ åº”ç”¨åœºæ™¯

#### åœºæ™¯1: äº§å“å¯¹æ¯”

```
å‚æ•°è®¾ç½®:
- num_frames: 40
- angle_deg: 0 (æ°´å¹³)
- smooth_width: 50
- edge_sharpness: 2.5
- edge_line_width: 3.0
- edge_line_color: "#0078ff"

è¿æ¥å…¬å¸logoåˆ°liner_image
â†’ ä¸“ä¸šçš„äº§å“å¯¹æ¯”åŠ¨ç”»
```

#### åœºæ™¯2: å‰åå¯¹æ¯”

```
å‚æ•°è®¾ç½®:
- num_frames: 30
- angle_deg: 90 (å‚ç›´)
- smooth_width: 40
- edge_sharpness: 2.0
- edge_line_width: 2.0
- edge_line_color: "#ffd700"

â†’ å±•ç¤ºä¿®å›¾å‰åæ•ˆæœ
```

#### åœºæ™¯3: æ—¶é—´çº¿å±•ç¤º

```
å‚æ•°è®¾ç½®:
- num_frames: 50
- angle_deg: 45 (æ–œå‘)
- smooth_width: 60
- edge_sharpness: 1.5
- edge_line_width: 0 (æ— çº¿)

â†’ å¹³æ»‘çš„æ—¶é—´å˜åŒ–å±•ç¤º
```

#### åœºæ™¯4: å“ç‰Œæ¨å¹¿

```
å‚æ•°è®¾ç½®:
- num_frames: 35
- angle_deg: 0
- smooth_width: 45
- edge_line_width: 4.0
- edge_line_color: [å“ç‰Œè‰²]
- liner_image: [å“ç‰ŒLogo]

â†’ å¸¦å“ç‰Œæ ‡è¯†çš„è¿‡æ¸¡åŠ¨ç”»
```

---

### ğŸ’¡ ä½¿ç”¨æŠ€å·§

#### æŠ€å·§1: é¢œè‰²æ­é…

```
æ·±è‰²å›¾ç‰‡ â†’ ä½¿ç”¨äº®è‰²çº¿:
#ffffff (ç™½), #ffd700 (é‡‘), #00ffff (é’)

äº®è‰²å›¾ç‰‡ â†’ ä½¿ç”¨æ·±è‰²çº¿:
#000000 (é»‘), #0078ff (æ·±è“), #8a2be2 (ç´«)

æš–è‰²è°ƒ â†’ ä½¿ç”¨æš–è‰²çº¿:
#ffd700 (é‡‘), #ff8c00 (æ©™), #ff0000 (çº¢)

å†·è‰²è°ƒ â†’ ä½¿ç”¨å†·è‰²çº¿:
#0078ff (è“), #00ffff (é’), #8a2be2 (ç´«)
```

#### æŠ€å·§2: å‚æ•°ç»„åˆ

**å¹³æ»‘æŸ”å’Œ**:
```
smooth_width: 60-100
edge_sharpness: 1.0-1.5
edge_line_width: 0
```

**æ¸…æ™°é†’ç›®**:
```
smooth_width: 30-40
edge_sharpness: 3.0-5.0
edge_line_width: 3.0-5.0
```

**ä¸“ä¸šå•†åŠ¡**:
```
smooth_width: 40-50
edge_sharpness: 2.0-2.5
edge_line_width: 2.0-3.0
edge_line_color: "#0078ff"
+ å…¬å¸Logo
```

#### æŠ€å·§3: å›¾æ ‡è®¾è®¡

```
ç®€æ´å›¾æ ‡ + ç»†çº¿ (1.0-2.0):
â†’ ç²¾è‡´ã€ä¸“ä¸š

ä¸­ç­‰å›¾æ ‡ + ä¸­çº¿ (2.0-3.0):
â†’ å¹³è¡¡ã€åè°ƒ â­

å¤§å›¾æ ‡ + ç²—çº¿ (5.0+):
â†’ é†’ç›®ã€å¼ºçƒˆ
```

#### æŠ€å·§4: è§’åº¦é€‰æ‹©

```
äº§å“å¯¹æ¯”: 0Â° (æ°´å¹³)
æ—¶é—´è½´: 0Â° æˆ– 90Â° (å‚ç›´)
åˆ›æ„æ•ˆæœ: 45Â° æˆ– -45Â° (æ–œå‘)
ç¯ç»•æ•ˆæœ: å¯åˆ¶ä½œå¤šä¸ªè§’åº¦åˆæˆ
```

---

### ğŸ”§ æŠ€æœ¯ç»†èŠ‚

#### è¾¹ç¼˜é”åŒ–ç®—æ³•

```python
# ä½¿ç”¨å¹‚å‡½æ•°å®ç°éçº¿æ€§è¿‡æ¸¡
alpha_centered = alpha * 2.0 - 1.0  # [0,1] â†’ [-1,1]
alpha_sharpened = sign(alpha_centered) * |alpha_centered|^(1/sharpness)
alpha = (alpha_sharpened + 1.0) / 2.0  # [-1,1] â†’ [0,1]
```

#### è¾¹ç¼˜çº¿ç»˜åˆ¶

```python
# è®¡ç®—è·ç¦»è¾¹ç¼˜ä¸­å¿ƒçš„è·ç¦»
distance_from_edge = |alpha - 0.5| * smooth_width

# åˆ¤æ–­æ˜¯å¦åœ¨çº¿å®½èŒƒå›´å†…
if distance_from_edge <= edge_line_width / 2:
    # æ··åˆè¾¹ç¼˜çº¿é¢œè‰²
    frame = frame * (1 - line_mask) + line_color * line_mask
```

#### å›¾æ ‡å®šä½

```python
# 1. æ‰¾åˆ°è¾¹ç¼˜ä¸­å¿ƒçº¿ (alpha â‰ˆ 0.5)
center_mask = |alpha - 0.5| < 0.01

# 2. è®¡ç®—è´¨å¿ƒ
center_y = mean(center_pixels_y)
center_x = mean(center_pixels_x)

# 3. å±…ä¸­æ”¾ç½®å›¾æ ‡
start_y = center_y - icon_height / 2
start_x = center_x - icon_width / 2

# 4. Alphaæ··åˆ
blended = background * (1 - mask) + icon * mask
```

---

### ğŸ¬ å®Œæ•´å·¥ä½œæµç¤ºä¾‹

#### ç¤ºä¾‹1: å¸¦Logoçš„äº§å“å¯¹æ¯”

```
å·¥ä½œæµ:
[Load Image: äº§å“æ—§ç‰ˆ.png] â†’ top_image
[Load Image: äº§å“æ–°ç‰ˆ.png] â†’ bottom_image
[Load Image: å…¬å¸Logo.png] â†’ liner_image
[Image to Mask: Logo] â†’ liner_image_mask
    â†“
[PD:Image FengMian Wipe]
- num_frames: 40
- angle_deg: 0
- smooth_width: 45
- edge_sharpness: 2.5
- edge_line_width: 3.0
- edge_line_color: "#0078ff"
- liner_image: å·²è¿æ¥
- liner_image_mask: å·²è¿æ¥
    â†“ frames
[PD:Image List To Gif/Video]
- format: "mp4"
- frame_rate: 24
    â†“
ä¸“ä¸šäº§å“å¯¹æ¯”è§†é¢‘ï¼
```

#### ç¤ºä¾‹2: ç®€æ´è¿‡æ¸¡åŠ¨ç”»

```
å·¥ä½œæµ:
[Load Image: å›¾A] â†’ top_image
[Load Image: å›¾B] â†’ bottom_image
    â†“
[PD:Image FengMian Wipe]
- num_frames: 30
- angle_deg: 90
- smooth_width: 40
- edge_sharpness: 2.0
- edge_line_width: 2.0
- edge_line_color: "#ffffff"
    â†“ frames
[Save Image]
æˆ–
[PD:Image List To Gif/Video]
```

---

## ğŸ¥ PD:Image List To Gif/Video

å°†å›¾åƒåºåˆ—è½¬æ¢ä¸ºGIFã€WebPæˆ–MP4æ ¼å¼ã€‚

### è¾“å…¥å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | èŒƒå›´ | è¯´æ˜ |
|------|------|--------|------|------|
| `images` | IMAGE | - | - | å›¾åƒåºåˆ—è¾“å…¥ |
| `frame_rate` | FLOAT | 8.0 | 1.0-60.0 | å¸§ç‡ï¼ˆfpsï¼‰ |
| `loop_count` | INT | 0 | 0-100 | å¾ªç¯æ¬¡æ•°ï¼ˆ0=æ— é™ï¼Œä»…GIF/WebPï¼‰ |
| `filename_prefix` | STRING | "FengMian" | - | æ–‡ä»¶åå‰ç¼€ |
| `output_folder` | STRING | "imagefengmian_gif" | - | è¾“å‡ºç›®å½• |
| `format` | STRING | "gif" | gif/webp/mp4 | è¾“å‡ºæ ¼å¼ â­ |
| `pingpong` | BOOLEAN | False | - | æ¥å›æ’­æ”¾æ•ˆæœ |
| `save_output` | BOOLEAN | True | - | æ˜¯å¦ä¿å­˜æ–‡ä»¶ |

### è¾“å‡º

| è¾“å‡º | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `filepath` | STRING | ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ |

**å‰ç«¯é¢„è§ˆ**: æ”¯æŒGIF/WebP/MP4çš„å®æ—¶é¢„è§ˆæ˜¾ç¤º

---

### ğŸ“Š æ ¼å¼å¯¹æ¯”

| æ ¼å¼ | æ–‡ä»¶å¤§å° | é¢œè‰²è´¨é‡ | æ’­æ”¾æ§ä»¶ | å…¼å®¹æ€§ | æ¨èåœºæ™¯ |
|------|---------|---------|---------|--------|---------|
| **GIF** | âŒ å¤§ | âŒ 256è‰² | âŒ æ—  | âœ… æœ€å¥½ | ç®€å•åŠ¨ç”» |
| **WebP** | âœ… å° | âœ… å…¨å½© | âŒ æ—  | âš ï¸ ç°ä»£ | è´¨é‡åŠ¨ç”» |
| **MP4** ğŸ†• | **âœ… æœ€å°** | **âœ… å…¨å½©** | **âœ… æœ‰** | **âœ… å¥½** | **ä¸“ä¸šè§†é¢‘** â­ |

### MP4çš„ä¼˜åŠ¿

#### vs GIF
```
æ–‡ä»¶å¤§å°: MP4çº¦ä¸ºGIFçš„ 1/10
é¢œè‰²æ•°: 1600ä¸‡è‰² vs 256è‰²
ç”»è´¨: é«˜è´¨é‡ vs æœ‰æŸå‹ç¼©
æ§ä»¶: æœ‰æ’­æ”¾æ§ä»¶ vs æ— 
```

#### vs WebP
```
æ–‡ä»¶å¤§å°: MP4æ›´å°
å…¼å®¹æ€§: MP4æ›´å¹¿æ³›
ç¼–è¾‘å·¥å…·: MP4å·¥å…·æ›´å¤š
æ’­æ”¾æ§ä»¶: MP4æœ‰å®Œæ•´æ§ä»¶
```

---

### ğŸ¨ å‚æ•°è¯¦è§£

#### formatï¼ˆè¾“å‡ºæ ¼å¼ï¼‰

**GIFæ ¼å¼**:
```
ç‰¹ç‚¹:
- å…¼å®¹æ€§æœ€å¥½
- æ–‡ä»¶è¾ƒå¤§
- 256è‰²é™åˆ¶
- è‡ªåŠ¨å¾ªç¯

é€‚ç”¨:
- ç®€å•å›¾å½¢åŠ¨ç”»
- è¡¨æƒ…åŒ…
- éœ€è¦å¹¿æ³›å…¼å®¹çš„åœºæ™¯
```

**WebPæ ¼å¼**:
```
ç‰¹ç‚¹:
- æ–‡ä»¶è¾ƒå°
- å…¨å½©æ”¯æŒ
- è´¨é‡è¾ƒå¥½
- éœ€è¦ç°ä»£æµè§ˆå™¨

é€‚ç”¨:
- ç½‘é¡µåŠ¨ç”»
- é«˜è´¨é‡è¦æ±‚
- ç°ä»£å¹³å°
```

**MP4æ ¼å¼** ğŸ†•:
```
ç‰¹ç‚¹:
- æ–‡ä»¶æœ€å°
- å…¨å½©é«˜è´¨é‡
- æœ‰æ’­æ”¾æ§ä»¶
- å¹¿æ³›æ”¯æŒ

é€‚ç”¨:
- ä¸“ä¸šè§†é¢‘åˆ¶ä½œ â­
- äº§å“å±•ç¤º
- æ•™å­¦æ¼”ç¤º
- éœ€è¦æ’­æ”¾æ§ä»¶çš„åœºæ™¯
```

#### frame_rateï¼ˆå¸§ç‡ï¼‰

| å¸§ç‡ | æ•ˆæœ | æ–‡ä»¶å¤§å° | é€‚ç”¨åœºæ™¯ |
|------|------|---------|---------|
| 8-12 | GIFé£æ ¼ | æœ€å° | ç®€å•å¾ªç¯åŠ¨ç”» |
| **24** | **ç”µå½±æ„Ÿ** | ä¸­ç­‰ | **æ¨è** â­ |
| 30 | æµç•… | è¾ƒå¤§ | äº§å“å±•ç¤º |
| 60 | è¶…æµç•… | å¤§ | æ¸¸æˆå½•å± |

#### pingpongï¼ˆæ¥å›æ’­æ”¾ï¼‰

```
False (é»˜è®¤):
A â†’ B â†’ C â†’ D (ç»“æŸ/å¾ªç¯)
- å•å‘æ’­æ”¾
- æ–‡ä»¶è¾ƒå°

True:
A â†’ B â†’ C â†’ D â†’ C â†’ B â†’ A (å¾ªç¯)
- æ¥å›æ’­æ”¾æ•ˆæœ
- å¸§æ•°ç¿»å€
- é€‚åˆå¾ªç¯å±•ç¤º
```

---

### ğŸ’¡ ä½¿ç”¨å»ºè®®

#### æ¨èç»„åˆ1: ä¸“ä¸šè§†é¢‘è¾“å‡º

```
format: "mp4"
frame_rate: 24
pingpong: False

= æ–‡ä»¶å° + è´¨é‡é«˜ + ä¸“ä¸šæ„Ÿ
```

#### æ¨èç»„åˆ2: ç½‘é¡µåŠ¨ç”»

```
format: "webp"
frame_rate: 15
pingpong: True

= å¾ªç¯æµç•… + æ–‡ä»¶å¯æ§
```

#### æ¨èç»„åˆ3: å¿«é€Ÿé¢„è§ˆ

```
format: "gif"
frame_rate: 10
pingpong: False

= å¿«é€Ÿç”Ÿæˆ + å…¼å®¹æ€§å¥½
```

---

### ğŸ¬ å®Œæ•´å·¥ä½œæµ

#### å·¥ä½œæµ: äº§å“å±•ç¤ºè§†é¢‘

```
[Load Image: å›¾A] â”€â”€â”
[Load Image: å›¾B] â”€â”€â”¤
[Load Image: å›¾C] â”€â”€â”¼â†’ [PD:Image FengMian Wipe]
                    - num_frames: 30
                    - angle_deg: 0
                    - smooth_width: 40
                    - edge_line_width: 2.0
                    - edge_line_color: "#0078ff"
                        â†“ frames (90å¸§)
                    [PD:Image List To Gif/Video]
                    - format: "mp4" â­
                    - frame_rate: 24
                    - filename_prefix: "product_demo"
                        â†“
                    product_demo_0001.mp4
                    (çº¦2-5MBï¼Œé«˜è´¨é‡)
```

#### å·¥ä½œæµ: GIFè¡¨æƒ…åŒ…

```
[Load Images] â†’ images
    â†“
[PD:Image List To Gif/Video]
- format: "gif"
- frame_rate: 10
- pingpong: True
- loop_count: 0
    â†“
æœ‰è¶£çš„å¾ªç¯GIF
```

---

### ğŸ”§ MP4æŠ€æœ¯ç»†èŠ‚

#### è§†é¢‘ç¼–ç 

```python
# ä¼˜å…ˆä½¿ç”¨H.264ç¼–ç ï¼ˆæœ€å…¼å®¹ï¼‰
fourcc_options = [
    'avc1',  # H.264 (ä¼˜å…ˆ)
    'mp4v',  # MPEG-4 (å¤‡ç”¨)
]

# è‡ªåŠ¨é€‰æ‹©å¯ç”¨ç¼–ç å™¨
for fourcc in fourcc_options:
    video_writer = cv2.VideoWriter(...)
    if video_writer.isOpened():
        break
```

#### å‰ç«¯é¢„è§ˆ

```javascript
// è‡ªåŠ¨æ£€æµ‹æ ¼å¼
if (format.startsWith('video/')) {
    // ä½¿ç”¨ <video> æ ‡ç­¾
    element = document.createElement("video");
    element.controls = true;
    element.loop = true;
} else {
    // ä½¿ç”¨ <img> æ ‡ç­¾
    element = document.createElement("img");
}
```

---

### ğŸ“ æ–‡ä»¶å¤§å°ä¼°ç®—

#### ç¤ºä¾‹: 1920x1080åˆ†è¾¨ç‡

| æ ¼å¼ | 30å¸§ | 60å¸§ | å¯¹æ¯” |
|------|------|------|------|
| GIF | ~30MB | ~60MB | åŸºå‡† |
| WebP | ~8MB | ~16MB | å‡å°‘73% |
| **MP4** | **~3MB** | **~6MB** | **å‡å°‘90%** âœ… |

---

### âš ï¸ æ³¨æ„äº‹é¡¹

#### 1. loop_countå¯¹MP4æ— æ•ˆ

```
loop_countå‚æ•°ä»…å¯¹GIF/WebPæœ‰æ•ˆ
MP4çš„å¾ªç¯ç”±æ’­æ”¾å™¨æ§åˆ¶
å‰ç«¯é¢„è§ˆå·²é»˜è®¤è®¾ç½®å¾ªç¯æ’­æ”¾
```

#### 2. OpenCVä¾èµ–

```
éœ€è¦å®‰è£…: opencv-python

æ£€æŸ¥æ˜¯å¦å·²å®‰è£…:
pip show opencv-python

å¦‚æœªå®‰è£…:
pip install opencv-python
```

#### 3. ç¼–ç å™¨æ”¯æŒ

```
Windows: é€šå¸¸å†…ç½®ç¼–ç å™¨
Linux: å¯èƒ½éœ€è¦å®‰è£… ffmpeg
MacOS: é€šå¸¸æ”¯æŒè‰¯å¥½

å¦‚é‡ç¼–ç é”™è¯¯:
sudo apt-get install ffmpeg  # Linux
brew install ffmpeg          # MacOS
```

#### 4. æ–‡ä»¶è·¯å¾„

```
è¾“å‡ºè·¯å¾„:
ComfyUI/output/{output_folder}/{filename}.{ext}

ç¤ºä¾‹:
output_folder = "my_videos"
filename_prefix = "demo"
â†’ ComfyUI/output/my_videos/demo_0001.mp4
```

---

### ğŸ¯ å¿«é€Ÿå¼€å§‹

#### æœ€ç®€å•çš„MP4è¾“å‡º

```
[ä»»æ„å›¾åƒåºåˆ—] â†’ images
    â†“
[PD:Image List To Gif/Video]
- format: "mp4"
- frame_rate: 24
- å…¶ä»–ä¿æŒé»˜è®¤
    â†“
ç‚¹å‡»æ‰§è¡Œï¼
```

#### æœ€ç®€å•çš„GIFè¾“å‡º

```
[ä»»æ„å›¾åƒåºåˆ—] â†’ images
    â†“
[PD:Image List To Gif/Video]
- format: "gif"
- frame_rate: 10
- pingpong: True
    â†“
å¾ªç¯GIFå®Œæˆï¼
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ç¤ºä¾‹

### ç¤ºä¾‹1: åŸºç¡€å›¾ç‰‡è¿‡æ¸¡

```
1. æ·»åŠ ä¸¤ä¸ª [Load Image] èŠ‚ç‚¹
2. æ·»åŠ  [PD:Image FengMian Wipe]
3. è¿æ¥å›¾ç‰‡åˆ° top_image å’Œ bottom_image
4. ä¿æŒé»˜è®¤å‚æ•°
5. è¿æ¥ frames åˆ° [Save Image]
6. æ‰§è¡Œï¼
```

### ç¤ºä¾‹2: å¸¦å“ç‰ŒLogoçš„è§†é¢‘

```
1. å‡†å¤‡ï¼šäº§å“å›¾Aã€äº§å“å›¾Bã€å…¬å¸Logo.png
2. æ·»åŠ  [PD:Image FengMian Wipe]
3. è®¾ç½®å‚æ•°ï¼š
   - edge_line_width: 3.0
   - edge_line_color: "#0078ff"
4. è¿æ¥Logoå’ŒMask
5. è¿æ¥åˆ° [PD:Image List To Gif/Video]
6. è®¾ç½® format: "mp4"
7. æ‰§è¡Œè·å¾—ä¸“ä¸šè§†é¢‘ï¼
```

### ç¤ºä¾‹3: å¿«é€ŸGIFåŠ¨ç”»

```
1. æ·»åŠ  [Load Images] (æ‰¹é‡åŠ è½½)
2. è¿æ¥åˆ° [PD:Image List To Gif/Video]
3. è®¾ç½®ï¼š
   - format: "gif"
   - frame_rate: 10
   - pingpong: True
4. æ‰§è¡Œè·å¾—å¾ªç¯GIFï¼
```

---

## ğŸ“š å®Œæ•´å‚æ•°é€ŸæŸ¥è¡¨

### PD:Image FengMian Wipe

| å‚æ•° | æ¨èå€¼ | è¯´æ˜ |
|------|--------|------|
| num_frames | 30-40 | è¿‡æ¸¡å¸§æ•° |
| angle_deg | 0, 90, 45 | æ“¦é™¤è§’åº¦ |
| smooth_width | 40-50 | æ¸å˜å®½åº¦ |
| edge_sharpness | 2.0-2.5 | è¾¹ç¼˜é”åŒ– |
| edge_line_width | 2.0-3.0 | è¾¹ç¼˜çº¿ç²—ç»† |
| edge_line_color | "#0078ff" | è“è‰²ï¼ˆæ¨èï¼‰ |

### PD:Image List To Gif/Video

| å‚æ•° | GIF | WebP | MP4 |
|------|-----|------|-----|
| format | "gif" | "webp" | "mp4" â­ |
| frame_rate | 10 | 15 | 24 |
| loop_count | 0 | 0 | (æ— æ•ˆ) |
| pingpong | True | False | False |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–

```
å¤§å°ºå¯¸å›¾ç‰‡:
- å…ˆé™ä½åˆ†è¾¨ç‡
- ä½¿ç”¨MP4æ ¼å¼
- å¸§ç‡ä¸è¶…è¿‡30

å°æ–‡ä»¶éœ€æ±‚:
- ä½¿ç”¨MP4æ ¼å¼
- é™ä½å¸§ç‡åˆ°15-20
- å‡å°‘å¸§æ•°
```

### 2. è´¨é‡ä¼˜åŒ–

```
é«˜è´¨é‡éœ€æ±‚:
- ä½¿ç”¨MP4æ ¼å¼
- å¸§ç‡24-30
- ä¿æŒåŸå§‹åˆ†è¾¨ç‡
- edge_sharpness: 2.0-3.0
```

### 3. å“ç‰ŒåŒ–å»ºè®®

```
ä¸“ä¸šæ¼”ç¤º:
- ä½¿ç”¨å“ç‰Œè‰²ä½œä¸ºè¾¹ç¼˜çº¿é¢œè‰²
- æ·»åŠ å…¬å¸Logoåˆ°liner_image
- ä½¿ç”¨MP4æ ¼å¼è¾“å‡º
- å¸§ç‡: 24fps
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: è¾¹ç¼˜çº¿çœ‹ä¸è§ï¼Ÿ

**A**: æ£€æŸ¥ `edge_line_width` æ˜¯å¦å¤§äº0ï¼Œä»¥åŠ `smooth_width` æ˜¯å¦ä¹Ÿå¤§äº0ï¼ˆè¾¹ç¼˜çº¿éœ€è¦åœ¨æ¸å˜å¸¦å†…ï¼‰ã€‚

### Q: å›¾æ ‡ä¸æ˜¾ç¤ºï¼Ÿ

**A**: ç¡®ä¿åŒæ—¶è¿æ¥äº† `liner_image` å’Œ `liner_image_mask`ï¼Œä¸¤è€…ç¼ºä¸€ä¸å¯ã€‚

### Q: MP4æ— æ³•ç”Ÿæˆï¼Ÿ

**A**: 
1. æ£€æŸ¥æ˜¯å¦å®‰è£…äº† opencv-python
2. Linux/Macå¯èƒ½éœ€è¦å®‰è£…ffmpeg
3. æŸ¥çœ‹ç»ˆç«¯æ—¥å¿—çš„é”™è¯¯ä¿¡æ¯

### Q: æ–‡ä»¶å¤ªå¤§ï¼Ÿ

**A**:
- GIF â†’ ä½¿ç”¨WebPæˆ–MP4
- é™ä½å¸§ç‡: 30 â†’ 24 â†’ 15
- å‡å°‘å¸§æ•°
- é™ä½åˆ†è¾¨ç‡

### Q: é¢„è§ˆä¸æ˜¾ç¤ºï¼Ÿ

**A**:
1. é‡å¯ComfyUI
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ (Ctrl+Shift+Del)
3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°(F12)çš„é”™è¯¯

---

## ğŸ“ å­¦ä¹ èµ„æº

### æ¨èå‚æ•°ç»„åˆ

**æ–°æ‰‹å…¥é—¨**:
```
num_frames: 30
angle_deg: 0
smooth_width: 40
edge_sharpness: 2.0
edge_line_width: 0
format: "gif"
frame_rate: 10
```

**ä¸“ä¸šåˆ¶ä½œ**:
```
num_frames: 40
angle_deg: 0
smooth_width: 45
edge_sharpness: 2.5
edge_line_width: 3.0
edge_line_color: "#0078ff"
+ Logoå›¾æ ‡
format: "mp4"
frame_rate: 24
```

**åˆ›æ„å®éªŒ**:
```
num_frames: 50
angle_deg: 45
smooth_width: 60
edge_sharpness: 1.5
edge_line_width: 5.0
edge_line_color: "#ff00ff"
format: "webp"
frame_rate: 20
pingpong: True
```

---

## ğŸ“„ è®¸å¯è¯

[åœ¨æ­¤æ·»åŠ æ‚¨çš„è®¸å¯è¯ä¿¡æ¯]

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“® è”ç³»æ–¹å¼

[åœ¨æ­¤æ·»åŠ æ‚¨çš„è”ç³»æ–¹å¼]

---

**ç‰ˆæœ¬**: v3.2
**æ›´æ–°æ—¥æœŸ**: 2025-11-15
**ComfyUIå…¼å®¹æ€§**: æœ€æ–°ç‰ˆæœ¬

**ä¸»è¦ç‰¹æ€§**:
- âœ… å›¾åƒæ“¦é™¤è¿‡æ¸¡åŠ¨ç”»
- âœ… å¯è°ƒèŠ‚è¾¹ç¼˜é”åŒ–å’ŒæŸ”å’Œåº¦
- âœ… å½©è‰²è¾¹ç¼˜çº¿ï¼ˆåå…­è¿›åˆ¶é¢œè‰²ï¼‰
- âœ… è¾¹ç¼˜çº¿å›¾æ ‡å åŠ 
- âœ… GIF/WebP/MP4å¤šæ ¼å¼è¾“å‡º
- âœ… å‰ç«¯å®æ—¶é¢„è§ˆï¼ˆå«è§†é¢‘æ’­æ”¾ï¼‰
- âœ… å®Œå…¨ä¸­æ–‡æ–‡æ¡£æ”¯æŒ

**æ¨èé…ç½®**: è¾¹ç¼˜çº¿ + Logo + MP4è¾“å‡º â­
